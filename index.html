<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>é»‘å±Â·ç‚¹å‡»Â·å®‹ä½“ Â· åå­—ä¸æ–°å¹´ï¼ˆå›¾ç‰‡ä¸åå­—åˆ†å¼€ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            background-color: #000000;
            font-family: 'SimSun', 'å®‹ä½“', 'Songti SC', serif;
            overflow: hidden;
        }

        .screen {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #000000;
        }

        /* æ­Œè¯åŒºåŸŸï¼šå›ºå®šåœ¨æœ€ä¸Šæ–¹ï¼Œå°å­—ï¼ŒåŠé€æ˜ */
        .lyrics {
            position: absolute;
            top: 12px;
            left: 0;
            width: 100%;
            text-align: center;
            font-family: 'SimSun', 'å®‹ä½“', serif;
            font-size: 0.9rem;
            color: rgba(200, 180, 150, 0.4);
            letter-spacing: 0.1rem;
            text-shadow: 0 0 8px rgba(255, 200, 100, 0.2);
            pointer-events: none;
            z-index: 40;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 0 16px;
            line-height: 1.4;
        }
        @media (max-width: 600px) {
            .lyrics {
                font-size: 0.75rem;
                top: 8px;
            }
        }

        .word {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            text-align: center;
            pointer-events: none;
            line-height: 1.2;
            font-weight: 400;
            letter-spacing: 0.02em;
            text-shadow: 0 0 20px currentColor;
        }

        .word-welcome {
            font-size: clamp(4rem, 18vw, 7rem);
            color: #ffe066;
        }
        .word-fengli {
            font-size: clamp(3.5rem, 14vw, 5.5rem);
            color: #9fc9f0;
        }
        .word-lili {
            font-size: clamp(3.5rem, 14vw, 5.5rem);
            color: #cfb0f0;
        }
        .word-apple {
            font-size: clamp(4rem, 16vw, 6.5rem);
            color: #b3e6a0;
        }
        .word-yuancai {
            font-size: clamp(3.5rem, 14vw, 5.5rem);
            color: #fcc2b3;
        }
        .word-yanxia {
            font-size: clamp(3.5rem, 14vw, 5.5rem);
            color: #f9cb9c;
        }
        .word-newyear {
            font-size: clamp(4.2rem, 18vw, 7.2rem);
            color: #ffb851;
        }

        .image-container {
            position: absolute;
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            gap: 5vw;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            width: 80%;
            max-width: 800px;
            flex-wrap: wrap;
        }

        .word-image {
            max-width: 35vw;
            max-height: 30vh;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8), 0 0 20px rgba(255, 255, 255, 0.1);
            background: rgba(0,0,0,0.3);
        }

        .hint {
            position: absolute;
            bottom: 35px;
            left: 0;
            width: 100%;
            text-align: center;
            font-family: 'SimSun', 'å®‹ä½“', serif;
            font-size: 1.2rem;
            letter-spacing: 0.2rem;
            color: rgba(180, 160, 130, 0.28);
            text-shadow: 0 0 8px rgba(255, 210, 150, 0.2);
            pointer-events: none;
            transition: opacity 0.25s;
            z-index: 10;
        }
        .hint span {
            border-bottom: 1px dashed rgba(200, 180, 140, 0.3);
            padding-bottom: 2px;
        }
        .hint-hidden {
            opacity: 0;
            visibility: hidden;
        }

        .audio-control {
            position: absolute;
            bottom: 25px;
            right: 25px;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(40, 40, 40, 0.6);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(220, 180, 100, 0.3);
            color: #ffda99;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 30;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            user-select: none;
            pointer-events: auto;
        }
        .audio-control:hover {
            background: rgba(70, 60, 40, 0.8);
            border-color: #ffb347;
            transform: scale(1.05);
        }
        .audio-control.muted {
            color: #aaa;
            border-color: #666;
            background: rgba(30, 30, 30, 0.8);
        }
        .audio-control span {
            line-height: 1;
            margin-top: -2px;
        }

        @media (max-width: 600px) {
            .word {
                top: 35%;
            }
            .image-container {
                top: 65%;
                gap: 3vw;
            }
            .word-image {
                max-width: 40vw;
                max-height: 25vh;
            }
            .hint {
                font-size: 1rem;
                bottom: 25px;
            }
            .audio-control {
                width: 42px;
                height: 42px;
                font-size: 20px;
                bottom: 15px;
                right: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="screen" id="screen">
        <!-- æ­Œè¯æ˜¾ç¤ºï¼šå›ºå®šåœ¨æœ€ä¸Šæ–¹ï¼Œè¯·è‡ªè¡Œä¿®æ”¹å†…å®¹ -->
        <div class="lyrics" id="lyricsDisplay">
            ğŸµ æœªæ¥å†è§ - é™¶å…¸ / Hanser / èŠ±ç² ğŸµ
        </div>

        <!-- è¯è¯­ -->
        <div class="word word-welcome" id="word-0">æ¬¢è¿</div>
        <div class="word word-fengli" id="word-1">é£ç¦»</div>
        <div class="word word-lili" id="word-2">é»ç¦»</div>
        <div class="word word-apple" id="word-3">ğŸ</div>
        <div class="word word-yuancai" id="word-4">æ²…é‡‡</div>
        <div class="word word-yanxia" id="word-5">çƒŸéœ</div>
        <div class="word word-newyear" id="word-6">æ–°å¹´å¿«ä¹ï¼</div>

        <!-- å›¾ç‰‡å®¹å™¨ï¼šä¸¤å¼ å›¾ç‰‡ -->
        <div class="image-container" id="imageContainer">
            <img id="img1" class="word-image" src="" alt="">
            <img id="img2" class="word-image" src="" alt="">
        </div>

        <div class="hint" id="tapHint"><span>âš¡ ç‚¹å‡»ä»»æ„å¤„ âš¡</span></div>
        <div class="audio-control" id="audioControl" title="å¼€å¯/å…³é—­èƒŒæ™¯éŸ³ä¹"><span>ğŸ”‡</span></div>
    </div>

    <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆåŒæ—¶æ”¯æŒMP3å’ŒFLACï¼‰ -->
    <audio id="bgMusic" loop preload="auto" style="display: none;">
        <source src="é™¶å…¸,Hanser,èŠ±ç² - æœªæ¥å†è§.mp3" type="audio/mpeg">
        <source src="é™¶å…¸,Hanser,èŠ±ç² - æœªæ¥å†è§.flac" type="audio/flac">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ audio å…ƒç´ ã€‚
    </audio>

    <script>
        (function() {
            // ----- è·å–å…ƒç´  -----
            const words = [
                document.getElementById('word-0'),
                document.getElementById('word-1'),
                document.getElementById('word-2'),
                document.getElementById('word-3'),
                document.getElementById('word-4'),
                document.getElementById('word-5'),
                document.getElementById('word-6')
            ];
            const img1 = document.getElementById('img1');
            const img2 = document.getElementById('img2');
            const imageContainer = document.getElementById('imageContainer');
            const hint = document.getElementById('tapHint');
            const screen = document.getElementById('screen');
            const audio = document.getElementById('bgMusic');
            const audioCtrl = document.getElementById('audioControl');
            const lyricsDisplay = document.getElementById('lyricsDisplay');

            // ----- å¸¸é‡ -----
            const totalWords = words.length;
            // å›¾ç‰‡æ˜ å°„ï¼šæ¯ä¸ªè¯è¯­ç´¢å¼•å¯¹åº”çš„å›¾ç‰‡æ–‡ä»¶åï¼ˆæ•°å­—éƒ¨åˆ†ï¼‰ï¼Œç©ºæ•°ç»„è¡¨ç¤ºæ— å›¾ç‰‡
            const imageMap = [
                [],                // 0: æ¬¢è¿
                [1, 2],            // 1: é£ç¦»
                [3, 4],            // 2: é»ç¦»
                [5, 6],            // 3: ğŸ
                [7, 8],            // 4: æ²…é‡‡
                [9, 10],           // 5: çƒŸéœ
                []                 // 6: æ–°å¹´å¿«ä¹
            ];

            // ----- çŠ¶æ€å˜é‡ -----
            let currentIndex = -1;          // -1 è¡¨ç¤ºé»‘å±æ— å†…å®¹
            let showImages = false;          // trueè¡¨ç¤ºå½“å‰æ˜¾ç¤ºå›¾ç‰‡ï¼Œfalseè¡¨ç¤ºå½“å‰æ˜¾ç¤ºåå­—
            let isLocked = false;
            let fadeTimeout = null;
            let isMuted = true;

            // ----- è¾…åŠ©å‡½æ•° -----
            function hideHintPermanently() {
                hint.classList.add('hint-hidden');
            }

            function showHint() {
                hint.classList.remove('hint-hidden');
            }

            // è®¾ç½®æŒ‡å®šè¯è¯­çš„é€æ˜åº¦
            function setWordOpacity(index, opacityValue) {
                if (index >= 0 && index < totalWords) {
                    words[index].style.opacity = opacityValue;
                }
            }

            // è®¾ç½®å›¾ç‰‡å®¹å™¨é€æ˜åº¦
            function setImageContainerOpacity(opacityValue) {
                imageContainer.style.opacity = opacityValue;
            }

            // éšè—æ‰€æœ‰è¯è¯­
            function hideAllWords() {
                for (let i = 0; i < totalWords; i++) {
                    words[i].style.opacity = '0';
                }
            }

            // é¢„åŠ è½½æ‰€æœ‰å›¾ç‰‡
            function preloadImages() {
                for (let i = 1; i <= 10; i++) {
                    const img = new Image();
                    img.src = i + '.png';
                }
            }

            // ----- éŸ³é¢‘åˆå§‹åŒ– -----
            function initAudio() {
                audio.muted = true;
                isMuted = true;
                audioCtrl.innerHTML = '<span>ğŸ”‡</span>';
                audioCtrl.classList.add('muted');

                audio.addEventListener('error', function(e) {
                    console.warn('éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸HTMLæ”¾åœ¨åŒä¸€ç›®å½•ï¼Œä¸”æ–‡ä»¶åæ­£ç¡®ã€‚');
                }, { once: true });
            }

            function tryPlayAudio() {
                if (!audio.paused) return;
                let playPromise = audio.play();
                if (playPromise !== undefined) {
                    playPromise.catch(error => {
                        console.log('éŸ³é¢‘è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œè¯·ç‚¹å‡»æ§åˆ¶æŒ‰é’®æ‰‹åŠ¨æ’­æ”¾:', error);
                    });
                }
            }

            function toggleMute() {
                if (audio.muted) {
                    audio.muted = false;
                    isMuted = false;
                    audioCtrl.innerHTML = '<span>ğŸ”Š</span>';
                    audioCtrl.classList.remove('muted');
                } else {
                    audio.muted = true;
                    isMuted = true;
                    audioCtrl.innerHTML = '<span>ğŸ”‡</span>';
                    audioCtrl.classList.add('muted');
                }
            }

            // ----- æ ¸å¿ƒç‚¹å‡»é€»è¾‘ï¼ˆå›¾ç‰‡å’Œåå­—åˆ†ç¦»ï¼‰-----
            function handleScreenClick() {
                if (isLocked) return;

                // é¦–æ¬¡ç‚¹å‡»å°è¯•æ’­æ”¾éŸ³é¢‘
                if (currentIndex === -1) {
                    tryPlayAudio();
                }

                // è®¡ç®—ç›®æ ‡çŠ¶æ€
                let targetIndex = currentIndex;
                let targetShowImages = false; // é»˜è®¤ä¸æ˜¾ç¤ºå›¾ç‰‡

                if (currentIndex === -1) {
                    // é»‘å± -> æ˜¾ç¤ºç¬¬ä¸€ä¸ªè¯ï¼ˆæ¬¢è¿ï¼‰çš„åå­—
                    targetIndex = 0;
                    targetShowImages = false;
                } else {
                    const hasImages = imageMap[currentIndex] && imageMap[currentIndex].length > 0;
                    if (hasImages) {
                        if (!showImages) {
                            // å½“å‰æ˜¾ç¤ºåå­—ï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¾ç¤ºå›¾ç‰‡ï¼ˆè¯¥è¯ï¼‰
                            targetIndex = currentIndex;
                            targetShowImages = true;
                        } else {
                            // å½“å‰æ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€æ˜¾ç¤ºä¸‹ä¸€ä¸ªè¯çš„åå­—
                            targetIndex = (currentIndex + 1) % totalWords;
                            targetShowImages = false;
                        }
                    } else {
                        // å½“å‰è¯æ— å›¾ç‰‡ï¼Œç›´æ¥åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªè¯çš„åå­—
                        targetIndex = (currentIndex + 1) % totalWords;
                        targetShowImages = false;
                    }
                }

                // é”å®šï¼Œé˜²æ­¢è¿ç‚¹
                isLocked = true;

                // æ·¡å‡ºå½“å‰å†…å®¹ï¼šå¦‚æœæœ‰åå­—ï¼Œæ·¡å‡ºåå­—ï¼›å¦‚æœæœ‰å›¾ç‰‡ï¼Œæ·¡å‡ºå›¾ç‰‡
                if (currentIndex !== -1 && !showImages) {
                    // å½“å‰æ˜¾ç¤ºåå­—ï¼Œæ·¡å‡ºåå­—
                    setWordOpacity(currentIndex, '0');
                }
                if (currentIndex !== -1 && showImages) {
                    // å½“å‰æ˜¾ç¤ºå›¾ç‰‡ï¼Œæ·¡å‡ºå›¾ç‰‡
                    setImageContainerOpacity('0');
                }
                // å¦‚æœæ˜¯é»‘å±ï¼Œæ— éœ€æ·¡å‡ºä»»ä½•å†…å®¹

                // å»¶æ—¶æ·¡å…¥ç›®æ ‡å†…å®¹
                if (fadeTimeout) clearTimeout(fadeTimeout);
                fadeTimeout = setTimeout(() => {
                    // å‡†å¤‡å›¾ç‰‡ï¼šå¦‚æœæ˜¯æ˜¾ç¤ºå›¾ç‰‡çŠ¶æ€ï¼Œè®¾ç½®å›¾ç‰‡srcï¼›å¦åˆ™æ¸…ç©ºå›¾ç‰‡src
                    if (targetShowImages) {
                        const nums = imageMap[targetIndex] || [];
                        if (nums.length >= 2) {
                            img1.src = nums[0] + '.png';
                            img2.src = nums[1] + '.png';
                        } else {
                            img1.src = '';
                            img2.src = '';
                        }
                    } else {
                        img1.src = '';
                        img2.src = '';
                    }

                    // æ·¡å…¥ç›®æ ‡å†…å®¹
                    if (targetShowImages) {
                        // åªæ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸æ˜¾ç¤ºåå­—
                        if (targetIndex !== -1) {
                            setWordOpacity(targetIndex, '0'); // ç¡®ä¿åå­—éšè—
                        }
                        setImageContainerOpacity('1');
                    } else {
                        // åªæ˜¾ç¤ºåå­—ï¼Œä¸æ˜¾ç¤ºå›¾ç‰‡
                        if (targetIndex !== -1) {
                            setWordOpacity(targetIndex, '1');
                        }
                        setImageContainerOpacity('0');
                    }

                    // æ›´æ–°çŠ¶æ€
                    currentIndex = targetIndex;
                    showImages = targetShowImages;

                    // æç¤ºæ°¸ä¹…éšè—ï¼ˆä¸€æ—¦æœ‰è¿‡å†…å®¹ï¼‰
                    if (currentIndex !== -1) {
                        hideHintPermanently();
                    }

                    isLocked = false;
                    fadeTimeout = null;
                }, 220); // é»‘å±é—´éš™
            }

            // ----- åˆå§‹åŒ–é»‘å± -----
            function initBlack() {
                hideAllWords();
                setImageContainerOpacity('0');
                img1.src = '';
                img2.src = '';
                currentIndex = -1;
                showImages = false;
                showHint();
                if (fadeTimeout) {
                    clearTimeout(fadeTimeout);
                    fadeTimeout = null;
                }
                isLocked = false;
                initAudio();
                preloadImages();
            }

            // ----- äº‹ä»¶ç›‘å¬ -----
            screen.addEventListener('click', function(e) {
                if (e.target === audioCtrl || audioCtrl.contains(e.target)) {
                    return;
                }
                handleScreenClick();
            });

            screen.addEventListener('touchstart', function(e) {
                if (e.target === audioCtrl || audioCtrl.contains(e.target)) {
                    return;
                }
                e.preventDefault();
                handleScreenClick();
            }, { passive: false });

            audioCtrl.addEventListener('click', function(e) {
                e.stopPropagation();
                if (audio.paused) {
                    let playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(err => {
                            console.log('æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚', err);
                            alert('éŸ³é¢‘æ’­æ”¾å¤±è´¥ã€‚è¯·ç¡®ä¿ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ä¸HTMLåœ¨åŒä¸€æ–‡ä»¶å¤¹å†…ï¼š\n1. é™¶å…¸,Hanser,èŠ±ç² - æœªæ¥å†è§.mp3\n2. é™¶å…¸,Hanser,èŠ±ç² - æœªæ¥å†è§.flac');
                        });
                    }
                }
                toggleMute();
            });

            // å¯åŠ¨
            initBlack();
        })();
    </script>
    <!-- 
</body>
</html>
